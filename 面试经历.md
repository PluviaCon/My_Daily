# 面试阿里的经历

## 电话面试

我投的这个部门效率还很算很高,周三投了,第二天就约了电话面试.

有点意外问的全是和 React 相关的内容,CSS 和 JS 的内容都没问到.

主要是性能优化和跨组件处理和 Hook 原理这块.

能记起来的问题就这些,过了.

### 项目经历和用了哪些东西

这个就很传统,问了简历里的项目用了哪些技术栈,如实回答就好.

### NodeJS 和 浏览器事件执行顺序问题

突然问题来我一时没有记起来,后来想到了这篇文章,里面有详细的解释:
[一篇文章教会你 Event loop——浏览器和 Node](https://segmentfault.com/a/1190000013861128)

### React Hook 常用钩子

常用的几个就好:

-   `useState`
-   `useEffect`
-   `useRef`
-   `useCallback`
-   `useMemo`
-   `useContext`

可以不用说第三方库的 hook 组件,没必要.

### React 的性能优化方案

-   避免没有必要的卸载和更新
-   保持标签和 DOM 结构的稳定性
-   避免重复渲染,可以使用`shouldComponentUpdate`生命周期来对比有无变化的`props`和`state`来避免组件更新,对于基本类型和引用类型的不同所带来的`shouldComponentUpdate`周期无效的情况,可以看一下[immutable](https://immutable-js.github.io/immutable-js/)的使用.`hook`组件可以使用`memo`来阻止更新.
-   分离组件,尽量避免父组件的更新.
    比如,一个父组件里有循环出来的子组件,在更新 state 改变子组件数量或者值的时候,可以把改变的过程放在子组件完成或者是在父组件时将改变后的数据赋值给一个变量传入子组件中

### 如何定位系统性能需要改进的点

大概意思就是,如果系统中存在了导致页面卡顿或者某些奇怪故障的时候,如何去定位.

-   首先对页面进行测试,找出需要定位的页面或组件
-   通过`chrome`的`Performance`选项测试页面的渲染性能
-   查看网络请求`(Network 选项卡)`,通过`time`和`size`属性排序来对比占用网络资源多的请求
-   如果是`React`应用,可以使用 React 官方插件`React Developer Tools`来比较组件的渲染次数和 state,props 的变化

### React useEffect 返回函数(销毁时)在什么时候执行

官方文档上说的很清楚:

> React 何时清除 effect? React 会在组件卸载的时候执行清除操作. 正如之前学到的, effect 在每次渲染的时候都会执行. 这就是为什么 React 会在执行当前 effect 之前对上一个 effect 进行清除. 我们稍后将讨论为什么这将助于避免 bug 以及如何在遇到性能问题时跳过此行为.

### React useEffect 内使用 state 的方式

这一点经常在项目使用中用到,原因是 setState 的异步问题.

> 组件内部的任何函数, 包括事件处理函数和 effect, 都是从它被创建的那次渲染中被「看到」的.

例如当你在上一个函数中改变了某一个`State`的状态,然后想在下一个函数中调用,却发现`State`的值没有发生改变.

解决办法大概有三个:

-   使用`useRef`来同步数据
-   使用全局变量来存储,但是复杂类型数据不建议
-   使用`Context`或全局状态组件来管理状态
-   如果是链式调用(紧接着调用)可以考虑直接传值减少`State`变化,不容易复用组件

### React Hook 的性能优化方案

Hook 组件内的优化大体和 React 优化方式相同,但是有一些更值得注意的问题:

-   避免和`class`组件书写形式一样,`state`的定义要保持简洁,避免状态定义混乱以降低耦合和复杂度
-   `Effect`定义要注意第二参数的使用,即对监听的状态尽量减少,或者拆分
-   使用`useMemo`和`useCallback`来减少组件重新渲染
-   还有一些[其他的](https://www.v2ex.com/t/724286)

### React Hook 和 Class 组件形式的区别

老问题了,大概是这几个方面,或者可以参考这篇文章: [函数式组件与类组件有何不同？](https://overreacted.io/zh-hans/how-are-function-components-different-from-classes/)

-   在代码上,定义的方式不同
-   function 组件每次渲染都会有独立 props/state,而 class 组件总是会通过 this 拿到最新的 props/state
-   function 组件逻辑复用简单, 而 class 组件逻辑复用困难

### 跨端 App 的实现原理

我只有`Electron`开发经验和小程序开发经验,所以只浅显的说了一下我理解的实现原理:

原生开发直接将语言编译成可执行文件, 直接调用系统 API, 完成 UI 绘制等. 这类开发技术, 有着较高的运行效率, 但一般来说, 开发速度较慢, 技术要求较高.Electron 通过将 Chromium 和 Node.js 合并到同一个运行时环境中, 并将其打包为 Mac, Windows 和 Linux 系统下的应用来实现这一目的.

其他跨平台的方案大概也是这个原理,将平台所选的语言转换为原生的语言.

### 跨端 App 有哪些劣势

也是相同的:

-   性能不如原生
-   无法热更新
-   调试困难
-   开源库受限于平台的欢迎程度
-   协作成本高

更多可以参考这篇文章: [跨端方案的三大困境](http://www.ayqy.net/blog/cross-platform-pains/)

### 前端监控怎么实现

前端监控这方面我没有具体了解过,但是和面试官说了之后,他会引导你说一下实现的思路,具体到怎么监控,监控的逻辑,没问详细的技术.

可以参考掘金的这篇文章: [前端监控的设计和实现](https://juejin.cn/post/6844904138522755080).

### 自己开源项目的实现,加了那些功能

如实回答就好,主要讲一下实现了什么功能,对原有项目做了哪些更改最好.

### 我问他问题

很简单的问题,为啥没问我 css 之类的问题,面试官说没必要,很好,我很喜欢.

### 笔试

有些问题比较简单,直接记下题目就好

```js
/**
 * 说明：生成一个指定长度（默认6位）的随机字符，随机字符包含字母数字。
 * 输入：输入随机字符长度，无输入默认6位
 * 输出：随机字符，如"6bij0v"
 */
```

```js
// 在移动开发中会有触发比较频繁的事件，比如用户滚动屏幕引起图片的懒加载等；请完成下面函数throttle
```

```js
//有一个数组，里面只存在 _ 和 字母，比如 [‘_‘, ‘d’, ‘c’, ‘_‘, ‘e’, ‘_‘, ‘a’, ‘*‘]。现在需要把这个数组中的所有星号移动到左边，所有的字母移动到右边，所有字母的顺序不能改变。
```

```js
//创建一个 Promise Chain ，实现有序 Promise 的串行调用
```

## 二次电话面试

主要问了具体项目的实现,深入到了项目里的某一个点让你详细说明.

我主要遇到的是项目的性能优化(react 层面和网络其他层面),mobx 和 redux 对比,全局状态组件怎么实现的减少渲染来提升性能(这个说的棱模两可,实在记不住 mobx 怎么实现的精准找到需要更改的值儿不触发其他渲染的了,我还是停在了技术使用层面了).

下面先记录一下:

### umi 工程化理解(做了什么让代码变快的)

umi 是个企业级的前端框架,可以很好的和我们公司的业务匹配(多数中台),并且对旧项目代码有很高的的兼容性.

-   通过微内核架构把大量需要业务重复的代码插件化,配置即可使用,节省时间
-   组件太大时可以采用按需加载`(dynamic)`
-   可以使用`esbuild`进行压缩
-   使用`externals`属性将一些组件库排除在打包范围外,注意使用的时候需要同时引入`scripts`外部链接
-   通过配置`SplitChunks`属性,调整公共依赖的提取策略

### webpack 怎么实现的打包优化

### 项目的性能优化,除了代码层的

### React 的优化

### mobx 和 redux 的对比

### react hook 和 class 组件的区别,hook 的 setState 怎么实现的保存变量信息的.

### mobx 怎么实现的精准找到需要更改的值来减少渲染
